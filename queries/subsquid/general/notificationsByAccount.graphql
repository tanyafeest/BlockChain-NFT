#import "../../fragments/subsquidNft.graphql"
#import "../../fragments/nftDetails.graphql"

query notificationsByAccount($account: String!, $limit: Int = 30) {
  # get sale event
  events(
    limit: $limit
    where: { currentOwner_eq: $account, interaction_eq: BUY }
    orderBy: timestamp_DESC
  ) {
    id
    interaction
    timestamp
    currentOwner
    nft {
      ...subsquidNft
      ...nftDetails
    }
  }
  # get offer and offer_accept events
  offerEvents(
    limit: $limit
    where: {
      currentOwner_eq: $account
      AND: {
        interaction_eq: CREATE
        offer: { status_eq: ACTIVE }
        OR: { interaction_eq: ACCEPT, offer: { status_eq: ACCEPTED } }
      }
    }
    orderBy: timestamp_DESC
  ) {
    id
    interaction
    timestamp
    currentOwner
    offer {
      price
      nft {
        ...subsquidNft
        ...nftDetails
      }
    }
  }
}
